{% from 'macros.html' import input_field, display_errors %}
{{ display_errors(form) }}
<!-- Pull event information -->

<div class="centertext align-items-center">
<div class="container">
    <div class="introtext">
    <h1>{{ event['title'] }}</h1>
    <h2>{{ event['description'] }}</h2>
    <h5>Created by: {% for p in event.participants %}
		{% if p.is_admin %}
			{{ p.name }}</h5>
			{%endif%}
			{%endfor%}
    </div>
    <div class="tasks">
      <h5>Tasks</h5>
        {% for t in event.tasks %}
            <p>{{ t.task }}: {{ t.participant.name if t.is_assigned else "Unclaimed"}}</p>
        {% endfor %}
    </div>
    <a class="btn btn-outline-info col-sm-4 join my-4" href="/event/{{ event['id'] }}/newtask">Add Task</a>
	<br>
    <a class="btn btn-outline-info col-sm-4 join my-4" href="/event/{{ event['id'] }}/respond">Join Event</a>
</div>

    <div class="participanttable">
        <div class="container">
            <div class="timeslot-display">
					<!-- Test block because Mason's computer will not properly load data -->
					<!-- <div class="date">
						<h5><strong>wassup date</strong></h5>
						<br>
						<div class="timeslot" style="height:auto;width:auto;">
							<p><strong>1:00pm</strong></p>
							<p>Mason The Greatest fo all time who never once let up</p>
							<p>Bill</p>
						</div>
						<div class="timeslot" style="height:auto;width:auto;">
							<p><strong>2:00pm</strong></p>
							<p>Mason</p>
							<p>Bill</p>
						</div>
					</div> -->
                    {% for dateslot in event_dateslots %}
						<div class="date">
	                        <h5><strong>{{ dateslot.date }}</strong></h5>
							<br>
	                        {% for timeslot in dateslot.timeslots %}
	                            <div class="timeslot" style="height:auto;width:auto;">
	                                <p><strong>{{ timeslot.time.strftime("%I:%M %p") }}</strong></p>
	                                {% for p in participants %}
	                                    {% for pt in p.timeslots %}
	                                        {% if pt.time == timeslot.time %}
	                                            <p>{{ p.name }}</p>
	                                        {% endif %}
	                                    {% endfor %}
	                                {% endfor %}
	                            </div>
	                        {% endfor %}
						</div>
                    {% endfor %}
                    <br><br>
                    <a class="btn btn-outline-info col-sm-4 join my-4" href="/event/{{ event['id'] }}/new_dateslot">Add Another Date</a>
            </div>
        </div>
    </div>
    <!--<button class="btn btn-outline-info col-sm-4 join my-4" onclick="showparticipantform()">Join Event</button>-->

<!-- Form for adding participant -->
<div id="formshow" style="display: none;">
    <form class="col-sm-10 mx-auto" method="POST">
        <div class="container">
            <div class="text-center">
                {{ input_field(form, 'participantname', 'Participant Name') }}
                <button class="btn btn-info toggle-time-button my-3 btn-sm">Toggle time format</button>
                <p>Time slots are 30 minutes long and begin at indicated time.</p>
                <p>Hold Ctrl or Command(Mac) to select multiple time slots.</p>
            </div>
            <div class="timeslot-picker">
                {% for timeslot in form.timeslots %}
                    {{ form["slot_%s" % timeslot.strftime("%H%M")]()|safe }}
                {% endfor %}
            </div>
        </div>
        <input type="submit" value="Submit" class="btn btn-lg btn-primary my-3 float-right">
    </form>
</div>
</div>
<script src="/static/timeslot_picker.js"></script>
</script>
